@page
@model IndexModel
@using RecipeSharingApp.Models
@{
    ViewData["Title"] = "Discover Recipes";
}

<head>
    <style>
        .recipe-card {
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }

            .recipe-card:hover {
                transform: scale(1.02);
                box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
            }
    </style>
</head>

<div class="container py-5">
    <div class="position-relative">
        <h1 class="text-lg-center text-dark pb-1 mb-0">@ViewData["Title"]</h1>
        @* @if (User.Identity.IsAuthenticated) *@
        @* { *@
        @*     <a href="/AddRecipe" class="btn btn-secondary position-absolute end-0 top-50 translate-middle-y">Add recipe</a> *@
        @* } *@
    </div>
    <hr class="mb-2 mb-md-5 w-50 mx-lg-auto border-secondary">


    <form method="get" class="mb-4">
    <div class="row mb-4">
        <div class="col-md-3">
             <label for="FilterRegion" class="form-label">Region</label>
                <select id="FilterRegion" name="FilterRegion" class="form-select">
                <option value="">All regions</option>
                @foreach (var region in Model.AvailableRegions)
                {
                        if (string.Equals(Model.FilterRegion, region))
                        {
                            <option value="@region" selected>@region</option>
                        }
                        else
                        {
                            <option value="@region">@region</option>
                        }
                }
            </select>
        </div>

        <div class="col-md-3">
             <label for="FilterCategory" class="form-label">Category</label>
                <select id="FilterCategory" name="FilterCategory" class="form-select">
                <option value="">All categories</option>
                @foreach (var category in Model.AvailableCategories)
                {
                        if (string.Equals(Model.FilterRegion, category))
                        {
                            <option value="@category" selected>@category</option>
                        }
                        else
                        {
                            <option value="@category">@category</option>
                        }
                }
            </select>
        </div>

        <div class="col-md-3">
             <label for="FilterPreparationTimeRange" class="form-label">Preparation Time</label>
                <select id="FilterPreparationTimeRange" name="FilterPreparationTimeRange" class="form-select">
                <option value="">All preparation times</option>
                    @if (string.Equals(Model.FilterPreparationTimeRange, "0-30"))
                    {
                        <option value="0-30" selected>Max 30 minutes</option>
                    }
                    else
                    {
                        <option value="0-30">Max 30 minutes</option>
                    }
                    @if (string.Equals(Model.FilterPreparationTimeRange, "30-60"))
                    {
                        <option value="30-60" selected>30-60 minutes</option>
                    }
                    else
                    {
                        <option value="30-60">30-60 minutes</option>
                    }
                    @if (string.Equals(Model.FilterPreparationTimeRange, "60-90"))
                    {
                        <option value="60-90" selected>60-90 minutes</option>
                    }
                    else
                    {
                        <option value="60-90">60-90 minutes</option>
                    }
                    @if (string.Equals(Model.FilterPreparationTimeRange, "90+"))
                    {
                        <option value="90+" selected>More than 90 minutes</option>
                    }
                    else
                    {
                        <option value="90+">90+ minutes</option>
                    }
            </select>
        </div>

        <div class="col-md-3 d-flex align-items-end">
                <button type="submit" class="btn btn-primary w-100 mt-3 mt-md-0">Apply Filters</button>
        </div>
    </div>
</form>



   @*  recipes *@
    <div class="row">
        @if (Model.Recipes!=null && Model.Recipes.Any())
        {
            @foreach (var recipe in Model.Recipes)
            {
                <div class="col-md-4">
                    <div class="card mb-4 shadow-sm recipe-card">
                        <img src="@recipe.ImageUrl" class="card-img-top" alt="@recipe.Title">
                        <div class="card-body row">
                            <div class="col-10">
                                <h2 class="card-title fs-5 text-dark">@recipe.Title</h2>
                                <div class="card-text text-muted">
                                    <p class="fs-6 mb-1"><span class="fw-bold">Category:</span> @recipe.Category</p>
                                    <p class="fs-6 mb-1"><span class="fw-bold">Region:</span> @recipe.Region</p>
                                    <p class="fs-6 mb-1"><span class="fw-bold">Preparation Time:</span> @recipe.PreparationTime minutes</p>
                                </div>
                            </div>
                            <div class="col-2 d-flex justify-content-end align-items-center">
                                <a class="btn d-flex justify-content-center align-items-center btn-outline-primary stretched-link p-0 h-100 w-75" asp-page="/RecipeDetails" asp-route-id="@recipe.RecipeId">
                                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-chevron-right" viewBox="0 0 16 16">
                                        <path fill-rule="evenodd" d="M4.646 1.646a.5.5 0 0 1 .708 0l6 6a.5.5 0 0 1 0 .708l-6 6a.5.5 0 0 1-.708-.708L10.293 8 4.646 2.354a.5.5 0 0 1 0-.708" />
                                    </svg>
                                </a>
                            </div>
                        </div>
                    </div>
                </div>
            }
        }
        else
        {
            <p class="text-center text-muted">No recipes found matching your filters.</p>
        }
    </div>
</div>
